language: php

env:
  - secure: RZ6odm+SmLvo31JnYPeehcjTiIXbBsMnZJxjB0b+yvACD3fSeLGMJj7TYtzkwQ2PDzX+AyjyIPTVh184rF3YADe+iLt6gLUzH6HnFXdiToNvrlpdS15QmxoYWDGZ/LpU8xYdFhWCLwoT7qGNBDyIRtOymwRH9HzSla56BSV8A1tjLNwBRbp4vVx/of/DUR217W7fpBZqV7a0pcP1+pveDGwbCElRMDJ2+yGqwWPUW1dh5Lbii9Y6eT+f4+BLYyIyxDkBwrfkpzbmxapdSiqMUnJZM6YJb9FClDM8aMBliCfSYYCLrJJAGJHWSFW0t79Gnc9C5nWcDA9SXrNvR+ELJA==

build:
    pre_ci_boot:
        image_name: damejidloci/build-k5
        image_tag: 2
        pull: true
        options: "-e HOME=/root --privileged"

    cache: true
    cache_dir_list:
        - $HOME/.composer
        - $SHIPPABLE_BUILD_DIR/vendor

    ci:
      # install
      - composer self-update || echo "failed :("
      - time composer install --no-interaction --optimize-autoloader

      # script
      - ./vendor/bin/parallel-lint -e php,phpt --exclude vendor .
#      - ./vendor/bin/phpunit -c ./tests/phpunit.xml ./tests
#      - ./vendor/bin/phpcs --standard=DameJidloCodingStandard/ruleset.xml DameJidloCodingStandard/ tests/

    post_ci:
      - df

